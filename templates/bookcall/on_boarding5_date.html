<!doctype html>
{% load static %}
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PropStart</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!-- style css link -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <!-- Favicon link  -->
    <link rel="icon" type="image/x-icon" href="{% static 'images/Untitled_log.svg' %}">
    <!-- country code and flag link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
</head>

<body>
    <!-- Register Account Step 1 Start-->
    <div class="account_section_one">
        <div class="container account_section_main on_boarding_calendar">
            <div class="login_account_section_one on_boarding_calendar_setup">
                <p class="step_text">Step 05/06</p>
                <div class="account_logo">
                    <a href="{% url 'home' %}">
                        <img src="{% static 'images/logo.svg' %}" alt="">
                       </a>
                </div>
                <h4>Call Timing</h4>
                <form class="account_form" method="post">
                    {% csrf_token %}
                    {% if messages %}
                        {% for message in messages %}
                            {% if message == "success" %}
                                <p class='msgg' style='color:green;'>{{ message }}</p>
                            {% else %}
                                <p class='msgg' style='color:red;'>{{ message }}</p>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    <div class="input_group" style="position: relative;">
                        <label for="" class="form-label input_label">Date</label>
                        <div class="custom_select account_input" id="dateInput">
                            <div class="select_title">
                                <span class="selected" id="selected-date">Select</span>
                                <input type="hidden" value="" name="selecteddate" id="selecteddate">
                                <img src="{% static 'images/Vector (2).svg' %}" alt="">
                            </div>
                            <img src="{% static 'images/arrow-drop-down-line.svg' %}" alt="">
                        </div>
                        <div class="calendar_main_div detail_calendar_1" id="calendarId">
                            <div class="calendar">
                                <button class="next_pervious_btn" id="prev-btn">&#8249;</button>
                                <span id="current-date" class="month_header">August</span>
                                <button class="next_pervious_btn" id="next-btn">&#8250;</button>
                            </div>
                            <div class="days-of-week">
                                <div>S</div>
                                <div>M</div>
                                <div>T</div>
                                <div>W</div>
                                <div>T</div>
                                <div>F</div>
                                <div>S</div>
                            </div>
                            <div class="dates">
                                <!-- The dates will be dynamically generated using JavaScript -->
                            </div>
                        </div>
                    </div>
                    <div class="input_group" style="position: relative;">
                        <label for="" class="form-label input_label">Time</label>
                        <div class="custom_select account_input" id="setTime_dive">
                            <div class="select_title">
                                <span class="selected" id="clock">Select Time</span>
                                <input type='hidden' value="" name="clockinput" id="clockinput">
                                <img src="{% static 'images/Vector (2).svg' %}" alt="">
                            </div>
                            <img src="{% static 'images/arrow-drop-down-line.svg' %}" alt="">
                        </div>
                        <div class="clockDive" id="clockShow">
                            <div class="timeInput_div">
                                <p class="previous_hour_p">00</p>
                                <p class="previous_minute_p">00</p>
                                <p class="previous_second_p">00</p>
                                <p class="previous_AM"></p>
                            </div>
                            
                            <div class="timeInput_unDisabled">
                                <input type="number" class="unDisable_time_input number_hour" id="hours" placeholder="06" min="1" max="24">
                                <span> : </span>
                                <input type="number" class="unDisable_time_input number_minute" id="minutes" placeholder="28" min="0" max="59">
                                <span> : </span>
                                <input type="number" class="unDisable_time_input number_second" id="seconds" placeholder="55" min="0" max="59">
                                <input type="text" class="unDisable_time_input" id="ampm" value="AM">
                            </div>
                            <div class="timeInput_div">
                                <p class="next_hour_p">00</p>
                                <p class="next_minute_p">00</p>
                                <p class="next_second_p">00</p>
                                <p class="next_AM"></p>
                            </div>
                        </div>
                        <!-- <button onclick="setClock()">Set Time</button> -->
                    </div>
                    <a href="">
                        <button type="submit" class="login_button mt-5">Next</button>
                    </a>
                </form>
            </div>
          
        </div>
    </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>

    <!-- jquery cdn -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <!-- Load fullPage.js first -->
    {% comment %} <script src="{% static 'js/calendar.js' %}"></script> {% endcomment %}
    <script>
        // checkbox
        $(document).ready(function () {
            $('.checkbox_resident').click(function () {
                $('.checkbox_resident').not(this).prop('checked', false);
            });

            // custom selector
            $('.custom_select').on('click', function () {
                const $this = $(this);
                $this.toggleClass('active');
                $this.find('.select_menu').slideToggle(300);
            });

            $('.custom_select').on('focusout', function () {
                const $this = $(this);
                $this.removeClass('active');
                $this.find('.select_menu').slideUp(300);
            });

            $('.select_menu li').on('click', function () {
                const $this = $(this);
                const $customSelect = $this.parents('.custom_select');
                $customSelect.find('.selected').text($this.text());
                $customSelect.find('#data_input').val($this.attr('value'));
            });

            // calendar hide and show 
            $("body").click(function (event) {
                if (!$(event.target).closest("#dateInput").length && !$(event.target).closest("#calendarId").length) {
                    $("#calendarId").hide();
                }
            });
            $("#dateInput").click(function(){
                $("#calendarId").toggle();
            });

            // clock show and hide 
            $("body").click(function (event) {
                if (!$(event.target).closest("#setTime_dive").length && !$(event.target).closest("#clockShow").length) {
                    $("#clockShow").hide();
                }
            });

            $("#setTime_dive").click(function(){
                $("#clockShow").toggle();
            });
        })

       
        function updateClock() {
            const hours = parseInt($("#hours").val());
            const minutes = parseInt($("#minutes").val());
            const seconds = parseInt($("#seconds").val());
            const ampm = $("#ampm").val();
        
            // Check if the input is in a valid range
            if (!isNaN(hours) && !isNaN(minutes) && !isNaN(seconds) &&
                hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59 && seconds >= 0 && seconds <= 59) {
                const timeString = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')} ${ampm}`;
                $("#clock").text(timeString);
                $("#clockinput").val(timeString)
            } else {
                $("#clock").text("Select Time"); // Handle invalid input
            }
        
            // Update previous and next values
            $(".previous_hour_p").text(hours > 0 ? String(hours - 1).padStart(2, '0') : "00");
            $(".previous_minute_p").text(minutes > 0 ? String(minutes - 1).padStart(2, '0') : "00");
            $(".previous_second_p").text(seconds > 0 ? String(seconds - 1).padStart(2, '0') : "00");
            $(".previous_AM").text(ampm === "AM" ? "PM" : "AM");
        
            $(".next_hour_p").text(hours < 23 ? String(hours + 1).padStart(2, '0') : "00");
            $(".next_minute_p").text(minutes < 59 ? String(minutes + 1).padStart(2, '0') : "00");
            $(".next_second_p").text(seconds < 59 ? String(seconds + 1).padStart(2, '0') : "00");
            $(".next_AM").text(ampm);
        }
        
        
                // Call the function to initialize the clock display
                updateClock();
        
                // Set focus on the hours input field initially
                $("#hours").focus();

                $("input[type='number']").on("input", function () {
                    let value = this.value;
                    
                    // Remove any non-numeric characters
                    value = value.replace(/[^0-9]/g, '');
                    
                    // Limit the input to two digits
                    if (value.length > 2) {
                        value = value.slice(0, 2);
                        $("#error-message").text("Please enter only two digits.");
                    } else {
                        $("#error-message").text(""); // Clear the error message
                    }
                    
                    this.value = value; // Update the input value
                });
                
                        
                // Listen for keyboard arrow key events on the input fields
                $("input[type='number'], #ampm").on("keydown", function (event) {
                    const inputField = $(this);
                    if (event.key === "ArrowUp") {
                        inputField[0].stepUp();
                    } else if (event.key === "ArrowDown") {
                        inputField[0].stepDown();
                    }
                    updateClock();
                });
        
                // Listen for mouse scroll events on the input fields and AM/PM
                $("input[type='number'], #ampm").on("mousewheel DOMMouseScroll", function (event) {
                    const delta = event.originalEvent.wheelDelta || -event.originalEvent.detail;
                    if ($(this).is("#ampm")) {
                        if (delta > 0) {
                            $(this).val("AM");
                        } else {
                            $(this).val("PM");
                        }
                    } else {
                        if (delta > 0) {
                            $(this)[0].stepUp();
                        } else {
                            $(this)[0].stepDown();
                        }
                    }
                    updateClock();
                    event.preventDefault();
                });
    </script>

    {% comment %} calender {% endcomment %}
    <script>
// Get the current date
let currentDate = new Date();

// Function to update the displayed date and year
function updateDisplayedDate1() {
  const months = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December",
  ];
  document.getElementById("current-date").textContent =
    months[currentDate.getMonth()] + " " + currentDate.getFullYear();
}

// Function to update the selected date
function updateSelectedDate(selectedDate) {
  const selectedDateDisplay = document.getElementById("selected-date");
  selectedDateDisplay.textContent = selectedDate.toDateString();

  const selecteddates = document.getElementById("selecteddate");
  selecteddates.value = selectedDate.toDateString();
  
}

// Function to generate the static calendar dates
function generateCalendarDates1() {
  const datesElement = document.querySelector(".dates");
  datesElement.innerHTML = "";

  // Get the first day of the month
  const firstDayOfMonth = new Date(
    currentDate.getFullYear(),
    currentDate.getMonth(),
    1
  );

  // Get the last day of the month
  const lastDayOfMonth = new Date(
    currentDate.getFullYear(),
    currentDate.getMonth() + 1,
    0
  );

  // Get the starting day of the week for the first day of the month (0 = Sunday, 1 = Monday, ..., 6 = Saturday)
  const startingDayOfWeek = firstDayOfMonth.getDay();

  // Populate the previous month's days (if any)
  const prevMonthLastDay = new Date(
    currentDate.getFullYear(),
    currentDate.getMonth(),
    0
  );
  const prevMonthLastDate = prevMonthLastDay.getDate();

  for (let i = startingDayOfWeek - 1; i >= 0; i--) {
    const prevMonthDate = new Date(
      currentDate.getFullYear(),
      currentDate.getMonth() - 1,
      prevMonthLastDate - i
    );

    const dateItem = document.createElement("div");
    dateItem.className = "date-item previous-month";
    dateItem.textContent = prevMonthDate.getDate();
    dateItem.addEventListener("click", () => {
      updateSelectedDate(prevMonthDate);
      dateItem.classList.add("current-date");
      const dateItems = document.querySelectorAll(".date-item");
      dateItems.forEach((item) => {
        if (item !== dateItem) {
          item.classList.remove("current-date");
        }
      });
    });

    datesElement.appendChild(dateItem);
  }

  // Create the date items for each day in the current month
  for (let i = 1; i <= lastDayOfMonth.getDate(); i++) {
    const date = new Date(currentDate.getFullYear(), currentDate.getMonth(), i);

    const dateItem = document.createElement("div");
    dateItem.className = "date-item";
    dateItem.textContent = i;
    dateItem.addEventListener("click", () => {
      updateSelectedDate(date);
      dateItem.classList.add("current-date");
      const dateItems = document.querySelectorAll(".date-item");
      dateItems.forEach((item) => {
        if (item !== dateItem) {
          item.classList.remove("current-date");
        }
      });
    });

    // Highlight the current date
    if (date.toDateString() === new Date().toDateString()) {
      dateItem.classList.add("current-date");
    }

    datesElement.appendChild(dateItem);
  }
}

// Event listeners for previous and next buttons
document.getElementById("prev-btn").addEventListener("click", () => {
  currentDate.setMonth(currentDate.getMonth() - 1);
  updateDisplayedDate1();
  generateCalendarDates1();
});

document.getElementById("next-btn").addEventListener("click", () => {
  currentDate.setMonth(currentDate.getMonth() + 1);
  updateDisplayedDate1();
  generateCalendarDates1();
});

// Initial setup
updateDisplayedDate1();
generateCalendarDates1();

    </script>

</body>

</html>